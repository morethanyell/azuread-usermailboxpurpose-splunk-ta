{"basic_builder": {"appname": "TA-azure-user-mailbox-purpose", "friendly_name": "Azure User Mailbox Purpose", "version": "1.0.0", "author": "morethanyell", "description": "Collect users' Mailbox Purpose", "theme": "#0358a6", "large_icon": "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", "small_icon": "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", "visible": true, "tab_version": "4.4.1", "tab_build_no": "0", "build_no": 1}, "data_input_builder": {"datainputs": [{"index": "default", "sourcetype": "azure:aad:user:mailboxpurpose", "interval": "86400", "use_external_validation": true, "streaming_mode_xml": true, "name": "mailbox_purpose", "title": "Mailbox Purpose", "description": "Collect users' Mailbox Purpose", "type": "customized", "parameters": [{"required": true, "name": "app_client_id", "label": "App/Client ID", "default_value": "", "placeholder": "", "help_string": "Must have MailboxSettings.Read permission", "type": "text", "format_type": "text", "value": ""}, {"required": true, "name": "client_secret", "label": "Client Secret", "placeholder": "", "default_value": "", "help_string": "", "type": "password", "format_type": "password", "value": ""}, {"required": true, "name": "tenant_id", "label": "Tenant ID", "default_value": "", "placeholder": "", "help_string": "", "type": "text", "format_type": "text", "value": ""}], "data_inputs_options": [{"type": "customized_var", "name": "app_client_id", "title": "App/Client ID", "description": "Must have MailboxSettings.Read permission", "required_on_edit": false, "required_on_create": true, "format_type": "text", "default_value": "", "placeholder": ""}, {"type": "customized_var", "name": "client_secret", "title": "Client Secret", "description": "", "required_on_edit": false, "required_on_create": true, "format_type": "password", "default_value": "", "placeholder": ""}, {"type": "customized_var", "name": "tenant_id", "title": "Tenant ID", "description": "", "required_on_edit": false, "required_on_create": true, "format_type": "text", "default_value": "", "placeholder": ""}], "code": "\r\n# encoding = utf-8\r\n\r\nimport time\r\nimport json\r\nimport requests\r\nfrom concurrent.futures import ThreadPoolExecutor, as_completed\r\n\r\ndef get_access_token(helper, client_id, client_secret, token_url):\r\n    \r\n    data = {\r\n        \"grant_type\": \"client_credentials\",\r\n        \"client_id\": client_id,\r\n        \"client_secret\": client_secret,\r\n        \"scope\": \"https://graph.microsoft.com/.default\"\r\n    }\r\n    \r\n    helper.log_info(\"Retrieving access token from Graph.\")\r\n    \r\n    try:\r\n        \r\n        response = requests.post(token_url, data=data)\r\n        response.raise_for_status()\r\n        token_info = response.json()\r\n        \r\n        helper.log_info(f\"Access token for client id {client_id} has been granted...\")\r\n        \r\n        return token_info['access_token']\r\n    except requests.RequestException as e:\r\n        helper.log_error(f\"Error obtaining token: {e}\")\r\n        return None\r\n\r\ndef get_all_users(helper, token, url):\r\n    \r\n    headers = {\"Authorization\": f\"Bearer {token}\"}\r\n\r\n    response = requests.get(url, headers=headers)\r\n    \r\n    if response.status_code > 200:\r\n        return None\r\n    \r\n    response.raise_for_status()\r\n    \r\n    data = response.json()\r\n\r\n    next_url = data.get(\"@odata.nextLink\")\r\n\r\n    return data.get(\"value\", []), next_url\r\n\r\ndef get_user_purpose(helper, user_id, token):\r\n    \r\n    url = f\"https://graph.microsoft.com/v1.0/users/{user_id}/mailboxSettings/userPurpose\"\r\n    headers = {\"Authorization\": f\"Bearer {token}\"}\r\n\r\n    while True:\r\n        response = requests.get(url, headers=headers)\r\n\r\n        if response.status_code == 429:  # Rate limit hit\r\n            retry_after = int(response.headers.get(\"Retry-After\", 10))\r\n            helper.log_error(f\"Rate limited for {user_id}. Retrying in {retry_after} sec...\")\r\n            time.sleep(retry_after)\r\n            continue\r\n\r\n        if response.status_code == 200:\r\n            user_purpose = response.json().get(\"value\")\r\n            if user_purpose in ('linked', 'shared', 'room', 'equipment', 'others'):\r\n                return user_purpose \r\n            else:\r\n                return None\r\n\r\n        return None\r\n\r\ndef validate_input(helper, definition):\r\n    pass\r\n\r\ndef collect_events(helper, ew):\r\n    \r\n    CLIENT_ID = helper.get_arg('app_client_id')\r\n    CLIENT_SECRET = helper.get_arg('client_secret')\r\n    TENANT_ID = helper.get_arg('tenant_id')\r\n    \r\n    TOKEN_URL = f\"https://login.microsoftonline.com/{TENANT_ID}/oauth2/v2.0/token\"\r\n    GRAPH_API_URL = \"https://graph.microsoft.com/v1.0/users?$select=id,userPrincipalName,mail&$filter=userType eq 'Member'&\"\r\n    \r\n    log_level = helper.get_log_level()\r\n    \r\n    helper.set_log_level(log_level)\r\n    \r\n    helper.log_info(f\"Start of collection.\")\r\n    helper.log_info(f\"Logging level is set to: {log_level}\")\r\n    helper.log_info(f\"Collecting Azure Entra ID user objects' mailboxSettings-->userPurpose from Azure tenant {TENANT_ID}, using app/client {CLIENT_ID}\")\r\n    \r\n    token = get_access_token(helper, CLIENT_ID, CLIENT_SECRET, TOKEN_URL)\r\n    meta_source = f\"ms_aad_user:tenant_id:{TENANT_ID}\"\r\n    \r\n    ctr = 0\r\n    \r\n    helper.log_info(\"Concurrent Futures, multi-thread API calls start here.\")\r\n    \r\n    next_url = GRAPH_API_URL\r\n    \r\n    while next_url:\r\n        \r\n        helper.log_info(f\"Getting all users. Will start indexing data for every pagination.\")\r\n        \r\n        users, next_url = get_all_users(helper, token, GRAPH_API_URL)\r\n    \r\n        with ThreadPoolExecutor(max_workers=5) as executor:\r\n            future_to_user = {executor.submit(get_user_purpose, helper, user[\"id\"], token): user for user in users}\r\n\r\n            for future in as_completed(future_to_user):\r\n                user = future_to_user[future]\r\n                try:\r\n                    user_purpose = future.result()\r\n                    if user_purpose:\r\n                        \r\n                        user[\"mailboxSettingsUserPurpose\"] = user_purpose\r\n                        \r\n                        data_event = json.dumps(user, separators=(',', ':'))\r\n                        event = helper.new_event(source=meta_source, index=helper.get_output_index(), sourcetype=helper.get_sourcetype(), data=data_event)\r\n                        \r\n                        ctr = ctr + 1\r\n                        \r\n                        ew.write_event(event)\r\n                        \r\n                except Exception as e:\r\n                    helper.log_error(f\"Error processing user {user['id']}: {e}\")\r\n    \r\n    helper.log_info(f\"ThreadPoolExecutor has completed for all possible API calls. Total events ingested: {ctr}.\")\r\n    helper.log_info(\"End of collection.\")\r\n    ", "customized_options": [{"name": "app_client_id", "value": "36e85666-1f95-41f2-8fba-be70b5b2b930"}, {"name": "tenant_id", "value": "e2ba81b8-03fe-407c-96a1-f4bc0f512e7d"}], "uuid": "3b496c68bcdd4f2e926aea7b71b865d8"}]}, "global_settings_builder": {"global_settings": {"log_settings": {}}}, "sourcetype_builder": {"azure:aad:user:mailboxpurpose": {"metadata": {"event_count": 0, "data_input_name": "mailbox_purpose", "extractions_count": 0, "cims_count": 0}}}, "validation": {"validators": ["best_practice_validation", "data_model_mapping_validation", "field_extract_validation", "app_cert_validation"], "status": "job_finished", "validation_id": "v_1740171034_75", "progress": 1.0}}